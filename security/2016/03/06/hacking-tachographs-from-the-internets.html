<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Hacking industrial vehicles from the internet</title>
	
	<meta name="author" content="Jose Carlos Norte">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/assets/css/style.css" rel="stylesheet">

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
</head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com/jcarlosn">
				<i class="fa fa-github"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="http://twitter.com/jcarlosnorte">
				<i class="fa fa-twitter"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="mailto:jcarlos.norte@gmail.com">
				<i class="fa fa-envelope"></i>
			</a>
			
			<a class="navbar-brand" href="/">
				<img src="http://www.gravatar.com/avatar/726351295ec82e145928582f595aa3aa?s=35" class="img-circle" />
				
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/">Home</a></li>
				<li><a href="/categories.html">Categories</a></li>
				<li><a href="/tags.html">Tags</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/"><i class="fa fa-home"></i>Home</a></li>
			<li><a href="/categories.html"><i class="fa fa-folder"></i>Categories</a></li>
			<li><a href="/tags.html"><i class="fa fa-tags"></i>Tags</a></li>
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<div class="col-sm-3 sidebar hidden-xs" style="">
		<!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/">
		<img src="/assets/media/jcarlosn.png" class="img-circle" />
	</a>
	<h3 class="title">
        <a href="/"></a>
    </h3>
</header>


<div id="bio" class="text-center">
	Enterpreneur, Thinker, Agilist, Technology enthusiast, Computer programmer, I.T. security expert and FOSS supporter.
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com/jcarlosn">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com/jcarlosnorte">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="mailto:jcarlos.norte@gmail.com">
				<i class="fa fa-envelope fa-lg"></i>
			</a>
		</li>
		
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://linkedin.com/in/jcarlosn">
				<i class="fa fa-linkedin fa-lg"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="/feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>
</div>
<!-- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
  <h1>Hacking industrial vehicles from the internet </h1>
</div>
	
<article>

	<div class="col-sm-10">
	 <span class="post-date">
	   
	   March 
	   6th,
	   
	   2016
	 </span>
	  <div class="article_body">
	  <p>It is possible to <strong>monitor and control float trucks, public bus or delivery vans from the internet</strong>, obtaining their speed, position, and a lot
other parameters. You can even control some parameters of the vehicle or hack into the canbus of the vehicle remotely.</p>

<p>Those vehicles have a <strong>Telematics Gateway Unit (TGU)</strong>
 device and a 3g/4g/gprs/lte/edge/HDSPA modem to connect to the internet, with a public I.P. address.</p>

<p>There are thousands of TGU connected to the internet, with no authentication at all and with administrative interfaces
through a web panel or a telnet session.</p>

<h3 id="finding-publicly-exposed-tgus-in-the-internets">Finding publicly exposed TGUs in the internets</h3>

<p>There are tons of open TGU and similar vehicle appliances on the internet. One very interesting and easy to find
is the <strong><a href="http://www.mobile-devices.com/our-products/c4-max-smartbox/">c4max</a></strong>.</p>

<p>The c4max smartbox is a TGU with powerful capabilities, a simple console on port 23, and is easy to identify while scaning the
internet.</p>

<div style="text-align:center;margin:25px">
<img src="/assets/media/posts/C4max-365.png" />
</div>

<p>A quick search with shodan, reveals 733 open c4max devices on the internet, at the time of scanning. Because of the nature of these devices,
connected to the internet using mobile data plans and in industrial vehicles, the devices you can find vary a lot from time to time.</p>

<p>Scanning the internet yourself with masscan finds different industrial vechicles working at different hours.</p>

<p>The c4max can be found looking for port 23, and the banner ‘gps’ or ‘welcome on console’ or similar strings from the telnet console they provide.</p>

<p>An example with shodan:</p>

<p><strong><a href="https://www.shodan.io/search?query=port%3A23+gps+%22on+console%22">https://www.shodan.io/search?query=port%3A23+gps+%22on+console%22</a></strong></p>

<h3 id="what-can-be-done-inside-a-c4max-tgu">What can be done inside a c4max TGU</h3>

<p>The telnet interface has 3 screns: basic, advanced, and commands.</p>

<p>The basic interface:</p>

<div style="text-align:center;margin:25px">
<img src="/assets/media/posts/c4max_basics.png" />
</div>

<p>The advanced interface:</p>

<div style="text-align:center;margin:25px">
<img src="/assets/media/posts/c4max_advanced.png" />
</div>

<p>Commands:</p>

<div style="text-align:center;margin:25px">
<img src="/assets/media/posts/c4max_advanced.png" />
</div>

<p>Some interesting commands:</p>

<pre><code>Basics[C4E]&gt; iostate
Input 1 : Disconnected
Output 1 : Disconnected
Output 2 : Disconnected
Alarm : Disconnected
Ignition : Connected
Basics[C4E]&gt;
</code></pre>

<p>Retriving gps coordinates of the vehicle (removed some info from the output, replaced by XXX…):</p>

<pre><code>Basics[C4E]&gt; gpspos
Internal antenna
GPRMC Frame value is
$GPRMC XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

GPGGA Frame value is
$GPGGA,XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

Basics[C4E]&gt;
</code></pre>

<p>And with the gps coordinates, we can locate the vehicle in google maps, for example:</p>

<div style="text-align:center;margin:25px">
<img src="/assets/media/posts/geoloc.png" />
</div>

<p>List available modules:</p>

<pre><code>Basics[C4E]&gt; list
dbg
pdm
sql
wdg
boot
dhcpServer
sshTunnel
serialPPP
cpnManager
netMonitoring
boardsInfo
messageBrokerProxy
versionManager
messageBroker
config
dnsProxy
fileManager
dictionary
can
gps
ios
usb
bootReason
batt
leds
onewire
wifi
smartCardManager
j1587
j1708
j1850
j1939
kline
modem
nvram
usbHfk
chronoTachyGraph
sensors
dtc
jvm
obd
ibutton
dataEmitter
jbinaryGate
ledManager
network
adminProtocol
crashSensor
timeZoneManager
instantFixII
modemOperatorDriver
gpsOdometer
smartSensors
relayControl
driverBehavior
obdStacks
locales
fileSync
pwrManager
gpsMvtDetector
geoFencing
sensorsCalibration
updateManager
companionSoftwareClient
urlServer
gpsEcho
binaryGateMonitor
sensorsRecorder
messageGate
binaryGate
deadReckoning
speedDropControl
criticalCommandManager
cacheManager
update
acceleroMvtDetector
history
commandManager
dataRecorder
eeprom
Basics[C4E]&gt;
</code></pre>

<p>The can bus module:</p>

<pre><code>Basics[C4E]&gt; list can

com::mdi::drivers::can.activateDebug=0
com::mdi::drivers::can.active_protocols=255
Basics[C4E]&gt;
</code></pre>

<p>And with listdb, we can get a lot of information from the vehicle, the company that operates the vehicle, the driver etc, that
I will not post here, for obvious reasons, but some of the information form listdb:</p>

<pre><code>...
MDI_EXT_BATT_VOLTAGE='12687'
MDI_GPS_SPEED='0000090'
...
</code></pre>

<p>Modem information:</p>

<pre><code>Basics[C4E]&gt; modem
ppp0	XXXXXXXXXXX
APN: XXXXXXXXXXX
autoAPN: XXXXXXXXXXX
Your IMEI is : XXXXXXXXXXX
Your IMSI is : XXXXXXXXXXX
DNS servers are
nameserver XXXXXXXXXXX
nameserver XXXXXXXXXXX
In case of problem, check your configuration (with "list all" command)
Basics[C4E]&gt;
</code></pre>

<p>We can even geofence the vehicle (I don’t know what it would cause):</p>

<pre><code>com::mdi::services::geoFencing.periodInMs=5000
com::mdi::services::geoFencing.directory[0]=/mnt/user/writeDir/geofencing
com::mdi::services::geoFencing.directory[1]=/mnt/user/data/geofencing
com::mdi::services::geoFencing.directory[2]=/mnt/user/mmc/geofencing
com::mdi::services::geoFencing.areaModeSearch=0
</code></pre>

<h3 id="conclusion">Conclusion</h3>

<p>Telematic Gateway Units exposed to the internet with public addresses and no authentication can be used to remotely track
industrial vehicles, geofence them, change the mission route, if you read the schematics of these units:</p>

<p><strong><a href="http://www.neweagle.net/ProductDocumentation/Telematics/C4MAX_datasheet.pdf">http://www.neweagle.net/ProductDocumentation/Telematics/C4MAX_datasheet.pdf</a></strong></p>

<p>You can see this device is connected to the bus of the vehicle, to the ignition, to the battery… and the theoretical things that could cause
are very scary. Of course, not having one of these available and just testing in the wild is not reponsible, so I still don’t know how far
one can go with access to one of these devices. Caution is advised.</p>


	  </div>

		
		<ul class="tag_box list-unstyled list-inline">
		  <li><i class="fa fa-folder-open"></i></li>
		  
		  
			 
				<li><a href="/categories.html#security-ref">
					security <span>(3)</span>
					
				</a></li>
			
		  
		</ul>
		  

		
		<ul class="list-inline">
		  <li><i class="fa fa-tags"></i></li>
		  
		  
			 
				<li>
					<a href="/tags.html#security-ref">
					security <span>(3)</span>
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#tachograph-ref">
					tachograph <span>(1)</span>
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#canbus-ref">
					canbus <span>(1)</span>
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#vehicle-ref">
					vehicle <span>(1)</span>
					,
					</a>
				</li>
			 
				<li>
					<a href="/tags.html#industrial-ref">
					industrial <span>(1)</span>
					
					</a>
				</li>
			
		  
		  
		</ul>
		  

		<hr>

		<div>
      <section class="share col-sm-6">
        <h4 class="section-title">Share Post</h4>
        <a class="btn btn-default btn-sm twitter" href="http://twitter.com/share?text=Hacking industrial vehicles from the internet&via=jcarlosnorte"
           onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <i class="fa fa-twitter fa-lg"></i>
          Twitter
        </a>
        <a class="btn btn-default btn-sm facebook" href="https://www.facebook.com/sharer/sharer.php"
           onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <i class="fa fa-facebook fa-lg"></i>
          Facebook
        </a>
        <a class="btn btn-default btn-sm gplus"
           onclick="window.open('https://plus.google.com/share?url='+window.location.href, 'google-plus-share', 'width=490,height=530');return false;">
          <i class="fa fa-google-plus fa-lg"></i>
          Google+
        </a>
      </section>

      <section class="col-sm-6 author">
        <img src="/assets/media/jcarlosn.png" class="img-rounded author-image" />
        <h4 class="section-title author-name">Jose Carlos Norte</h4>
        <p class="author-bio">Enterpreneur, Thinker, Agilist, Technology enthusiast, Computer programmer, I.T. security expert and FOSS supporter.</p>
      </section>
    </div>

    <div class="clearfix"></div>

		<ul class="pager">
		  
		  <li class="previous"><a href="/security/2016/03/06/advanced-tor-browser-fingerprinting.html" title="Advanced Tor Browser Fingerprinting">&larr; Previous</a></li>
		  
		  
			<li class="next disabled"><a>Next &rarr;</a>
		  
		</ul>

		<hr>
	</div>
	
	<div class="col-sm-2 sidebar-2">

	</div>
</article>
<div class="clearfix"></div>



    
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'jcarlosn';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>





		<footer>
			<hr/>
			<p>
				&copy; 2016 Jose Carlos Norte
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/assets/resources/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/assets/js/app.js"></script>
</body>
</html>



<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-74110846-1', 'auto');
  ga('send', 'pageview');

</script>

